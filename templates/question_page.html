{% extends "base.html" %} {% block content %}
<div class="question-page">
  <h2 class="question-page__title">RAG Question Page</h2>

  <div class="question-page__settings">
    <h3 class="question-page__settings-title">Settings</h3>

    <label class="question-page__settings-label"
      >Documents to retrieve (k):</label
    >
    <input
      type="range"
      id="k"
      class="question-page__settings-input"
      min="1"
      max="10"
      value="{{ settings.k }}"
    />
    <span id="kValue" class="question-page__settings-value"
      >{{ settings.k }}</span
    ><br />

    <label class="question-page__settings-label">Score Threshold:</label>
    <input
      type="range"
      id="scoreThreshold"
      class="question-page__settings-input"
      min="0"
      max="1"
      step="0.01"
      value="{{ settings.score_threshold }}"
    />
    <span id="scoreThresholdValue" class="question-page__settings-value"
      >{{ settings.score_threshold }}</span
    ><br />

    <label class="question-page__settings-label">System Prompt:</label>
    <textarea id="systemPrompt" class="question-page__settings-textarea">
{{ settings.system_prompt }}</textarea
    ><br />

    <button class="button button--primary" onclick="updateQuestionSettings()">
      Save Settings
    </button>
  </div>

  <div class="question-page__query">
    <h3 class="question-page__query-title">Ask a Question</h3>
    <input
      type="text"
      id="queryInput"
      class="question-page__query-input"
      placeholder="Enter your question..."
    />
    <button class="button button--success" onclick="submitQuery()">
      Submit
    </button>
  </div>

  <div class="question-page__response">
    <h3 class="question-page__response-title">Response</h3>
    <div id="responseOutput" class="question-page__response-output"></div>
  </div>

  <div class="question-page__retrieved-docs">
    <h3 class="question-page__retrieved-docs-title">
      Retrieved Documents with Scores
    </h3>
    <div id="retrievedDocs" class="question-page__retrieved-docs-list"></div>
  </div>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const scoreThresholdSlider = document.getElementById("scoreThreshold");
      const scoreThresholdValue = document.getElementById(
        "scoreThresholdValue"
      );

      scoreThresholdValue.textContent = scoreThresholdSlider.value;

      scoreThresholdSlider.addEventListener("input", function () {
        scoreThresholdValue.textContent = scoreThresholdSlider.value;
      });

      const kSlider = document.getElementById("k");
      const kValue = document.getElementById("kValue");

      kValue.textContent = kSlider.value;

      kSlider.addEventListener("input", function () {
        kValue.textContent = kSlider.value;
      });
    });
  </script>
</div>
{% endblock %}
